<div class="news-container">
  <!-- New Stories Notification -->
  <app-news-notification
    [notification]="newStoriesNotification()"
    (refresh)="onRefreshStories()"
    (dismiss)="onDismissNotification()"
  />

  <h1>Hacker News Top Stories</h1>

  <!-- Debug/Test Controls (Development Only) -->
  <div class="debug-controls" style="margin-bottom: 1rem; padding: 0.5rem; background: #f0f0f0; border-radius: 4px; font-size: 0.9rem;">
    <strong>üß™ Test Controls:</strong>
    <button
      class="btn btn-secondary"
      style="margin-left: 0.5rem; padding: 0.25rem 0.5rem; font-size: 0.8rem;"
      (click)="simulateNewStories()"
    >
      Simulate New Stories
    </button>
    <button
      class="btn btn-secondary"
      style="margin-left: 0.5rem; padding: 0.25rem 0.5rem; font-size: 0.8rem;"
      (click)="clearNotification()"
    >
      Clear Notification
    </button>
    <button
      class="btn btn-secondary"
      style="margin-left: 0.5rem; padding: 0.25rem 0.5rem; font-size: 0.8rem;"
      (click)="triggerBackendNotification()"
    >
      Test Backend SignalR
    </button>
    <span style="margin-left: 0.5rem; color: #666; white-space: nowrap;">
      Cache Size: {{ cacheInfo() }} |
      Connected: {{ isConnected() ? '‚úÖ' : '‚ùå' }}
    </span>
  </div>

  <div class="search-box">
    <input 
      type="text" 
      [ngModel]="searchQuery()" 
      (ngModelChange)="searchQuery.set($event)"
      placeholder="Search stories by title..."
      aria-label="Search stories"
    >
  </div>
  
  @if (loading()) {
    <div class="loading">Loading stories...</div>
  } @else if (error()) {
    <div class="error">{{ error() }}</div>
  } @else {
    <div class="stories-list">
      @for (story of filteredStories(); track story.id) {
        <article class="story-card">
          <h2>
            <a [href]="story.url" target="_blank" rel="noopener">{{ story.title }}</a>
          </h2>
          <div class="story-meta">
            <span>{{ story.score }} points</span>
            <span>by {{ story.by }}</span>
            <span>{{ story.time | formatTime }}</span>
            <span>{{ story.descendants }} comments</span>
          </div>
        </article>
      }
    </div>

    <div class="pagination">
      <button
        class="btn btn-secondary"
        [disabled]="currentPage() === 1"
        (click)="previousPage()"
      >
        Previous
      </button>

      <span class="page-info">
        Page {{ currentPage() }} of {{ totalPages() }}
      </span>

      <button
        class="btn btn-primary"
        [disabled]="currentPage() === totalPages()"
        (click)="nextPage()"
      >
        Next
      </button>
    </div>
  }
</div>